<plantilla>
	<documento salida="impresora1">
		#if($imprimirLogo)
			<logo alignLogo="center"></logo>
		#end
		<linea> <texto> </texto> </linea>
		<linea><texto style ="1" size="39" align="center">CIERRE DE TIENDA</texto></linea>
		<linea><texto style ="1" size="39" align="center">=======================================</texto></linea>

		<linea>
			<texto size="15" align="left">Tienda: </texto>
			<texto size="24" align="left">${cierreDia.getTienda()}</texto> 
		</linea>

		<linea>
			<texto size="15" align="left">Fecha: </texto>
			<texto size="24" align="left">${cierreDia.getFechaString()}</texto> 
		</linea>

		<linea>
			<texto size="15" align="left">Fecha Listado: </texto>
			<texto size="24" align="left">${cierreDia.getFechaListadoString()}</texto> 
		</linea>
		
		<linea> <texto> </texto> </linea>

		<linea>
			<texto size="15" align="left">Tickets: </texto>
			<texto size="24" align="right">${cierreDia.getCaja().getTotalTicketsAsString()}</texto> 
		</linea>
	
		<!--Cargamos los datos de los importes de venta--> 
		#set($totalVentas=$cierreDia.getCaja().getTotalVentasEntrada())
		#set($totalDevoluciones=$cierreDia.getCaja().getTotalVentasSalida())
		#if(!$totalVentas)
		  #set($totalVentas=0)
		#end
		#if(!$totalDevoluciones)
		  #set($totalDevoluciones=0)
		#end
		#set($Total=$totalVentas.subtract($totalDevoluciones)) 
		<linea>
			<texto size="15" align="left">Venta Total:</texto> 

			#if ($Total != 0)
				<texto size="24" align="right">$fmt.formateaImporte($Total)</texto>
			#else
				<texto size="24" align="right">0,00</texto>
			#end
		</linea> 
		
		#set($TotalTerceros=0)
		#foreach($terceros in $cierreDia.getListMovimientosTerceros())
			#set($TotalTerceros=$TotalTerceros + $terceros.getCargo()) 
		#end 

		<linea>
			<texto size="15" align="left">Gesti√≥n Cobro: </texto>
           
			#if ($TotalTerceros != 0)
				<texto size="24" align="right">$fmt.formateaImporte($TotalTerceros)</texto>
			#else
				<texto size="24" align="right">0,00</texto>
			#end			
		</linea>
		
		<linea>
			<texto size="15" align="left">Abonos: </texto>
			<texto size="24" align="right">$cierreDia.getCaja().getTotalVentasSalidaAsString()</texto> 
		</linea>

		<linea><texto> </texto></linea>
		<linea><texto style ="1" size="39" align="center">****CUADRE CAJA****</texto></linea>

		<linea>
			<texto style ="1" size="17" align="left">Saldo Inicial: </texto>
			<texto style ="1" size="22" align="right">${cierreDia.getSaldoInicialString()}</texto> 
		</linea>

		
		#foreach($cobro in $cierreDia.getListResumenCobros())
			<linea>
				<texto size="17" align="left">${cobro.getDesMedPag()}</texto>
				<texto size="22" align="right">${cobro.getTotalAsString()}</texto>
			</linea>
		#end 

        #if($cierreDia.getListIngresoBanco() && !$cierreDia.getListIngresoBanco().isEmpty())
		   <linea><texto style ="1" size="39" align="left">SALIDAS CAJA</texto></linea>
			#foreach($movimiento in $cierreDia.getListIngresoBanco())
				<linea>				
					<texto size="14" align="left">${movimiento.getConcepto()}</texto> 
					<texto size="25" align="right">${movimiento.getTotalString()}</texto>
				</linea>
			#end 
		#end

		<linea>
			<texto size="17" align="left">Diferencia Caja:</texto>
            <texto size="22" align="right">${cierreDia.getCaja().getDescuadreAsString()}</texto>	
		</linea>
		
		#set($SaldoFinal= ${cierreDia.getTotalCobroEfectivo()} + ${cierreDia.getCaja().getDescuadre()})
		<linea>
			<texto style ="1" size="17" align="left">Saldo Final:</texto>
			<texto size="22" align="right">$fmt.formateaImporte($SaldoFinal)</texto> 
		</linea>

        <linea><texto> </texto></linea> 
		<linea><texto style ="1" size="39" align="center">****RESUMEN CIERRES EFECTIVOS****</texto></linea>

        <linea>
		   <texto size="16" align="right">Cobros</texto>
		   <texto size="23" align="right">Otros</texto>
		 </linea>
		<linea>
			<texto size="4" align="left">Caja</texto>
			<texto size="12" align="right">Efectivo</texto> 
			<texto size="13" align="right">Descuadre</texto>
			<texto size="10" align="right">Cobros</texto>
		</linea>		

		#foreach($arqueo in $cierreDia.getListResumenCierresEfectivo())
		<linea>
			<texto size="4" align="center">${arqueo.getCodCaja()}</texto>
			<texto size="12" align="right">${arqueo.getTotalString()}</texto> 
			<texto size="13" align="right">${arqueo.getDescuadreString()}</texto>
			<texto size="10" align="right">${arqueo.getOtrosString()}</texto>
		</linea>
		#end 

        <linea><texto> </texto></linea>
		<linea><texto style ="1" size="39" align="center">****MOVIMIENTOS CAJA****</texto></linea>

		<linea>
			<texto size="14" align="left">Cajero</texto> 
			<texto size="17" align="left">Fecha Alta</texto>
			<texto size="8" align="right">Importe</texto>
		</linea>
		
		#set($TotalSalidasCajaFuerte=0)
		#foreach($movimiento in $cierreDia.getListMovimientosBanco())
			#set($TotalSalidasCajaFuerte=$TotalSalidasCajaFuerte + $movimiento.getTotal().abs()) 
			<linea>
				<texto size="14" align="left">${movimiento.getUsuario()}</texto> 
				<texto size="17" align="left">${movimiento.getFechaString()}</texto>				

				#set($TotalLinea=$movimiento.getTotal())					
				#if($TotalLinea != 0)
					<texto size="8" align="right">$fmt.formateaImporte($TotalLinea.abs())</texto>
				#else
					<texto size="8" align="right">0,00</texto>
				#end
			</linea>
			<linea>
				<texto size="39" align="left">${movimiento.getConcepto()}</texto> 
			</linea>
		#end
		
		#set($TotalEntradasCajaFuerte=0)
		#foreach($movimiento in $cierreDia.getCaja().getMovimientosApuntes())
			#if($movimiento.getCodConceptoMovimiento().equals('01'))
				#set($TotalEntradasCajaFuerte=$TotalEntradasCajaFuerte + $movimiento.getTotal().abs()) 
				<linea>
					<texto size="14" align="left">${movimiento.getUsuario()}</texto> 
					<texto size="17" align="left">$fmt.formateaFechaCorta(${movimiento.getFecha()}) $fmt.formateaHora(${movimiento.getFecha()})</texto>	

                    #set($TotalLinea=$movimiento.getCargo() - $movimiento.getAbono())					
					#if($TotalLinea != 0)
						<texto size="8" align="right">$fmt.formateaImporte($TotalLinea.abs())</texto>
					#else
						<texto size="8" align="right">0,00</texto>
					#end
				</linea>
			
				<linea>
					<texto size="39" align="left">${movimiento.getConcepto()}</texto> 
				</linea>
			#end
		#end

		<linea>
		    <texto style ="1" size="5" align="left">Ent:</texto>
		    #if($TotalEntradasCajaFuerte != 0)
				<texto style ="1" size="8" align="right">$fmt.formateaImporte($TotalEntradasCajaFuerte.abs())</texto>
			#else
				<texto style ="1" size="8" align="right">0,00</texto>
			#end
			<texto style ="1" size="5" align="right"> Sal:</texto>
		    #if($TotalSalidasCajaFuerte != 0)
				<texto style ="1" size="8" align="right">$fmt.formateaImporte($TotalSalidasCajaFuerte.abs())</texto>
			#else
				<texto style ="1" size="8" align="right">0,00</texto>
			#end
			<texto style ="1" size="5" align="right"> Dif:</texto>
			#set($TotalDiferenciaCajaFuerte=$TotalEntradasCajaFuerte - $TotalSalidasCajaFuerte)
		    #if($TotalDiferenciaCajaFuerte != 0)
				<texto style ="1" size="8" align="right">$fmt.formateaImporte($TotalDiferenciaCajaFuerte)</texto>
			#else
				<texto style ="1" size="8" align="right">0,00</texto>
			#end
		</linea>

        #if($cierreDia.getListMovimientosTerceros() && !$cierreDia.getListMovimientosTerceros().isEmpty())
			<linea><texto> </texto></linea>
			<linea><texto style ="1" size="39" align="center">****GESTION COBRO****</texto></linea>
			<linea>
				<texto size="29" align="left">Descripcion</texto>
				<texto size="10" align="right">Importe</texto>
			</linea>
			#foreach($terceros in $cierreDia.getListMovimientosTerceros())
				<linea>
					<texto size="29" align="left">${terceros.getConcepto()}</texto>
					#set($totalMovimiento=$terceros.getCargo())
					#if($totalMovimiento != 0)
						<texto size="10" align="right">$fmt.formateaImporte($totalMovimiento)</texto>
					#else
						<texto size="10" align="right">0,00</texto>
					#end
				</linea>
			#end 
		#end 
		<linea> <texto> </texto> </linea>
		<linea> <texto> </texto> </linea>
		<corte></corte>
	</documento>
</plantilla>